<Window x:Class="PaintApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls" 
        Title="Paint App" Height="600" Width="800">

    <Window.Resources>
        <ContextMenu x:Key="LayerMenu">
            <MenuItem Header="Usuń warstwę" Click="RemoveLayer_Click" CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=Parent}"/>
            <MenuItem Header="Powiel warstwę" Click="DuplicateLayer_Click" CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=Parent}"/>
            <MenuItem Header="Ukryj/Pokaż warstwę" Click="ShowHideLayer_Click" CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=Parent}"/>
        </ContextMenu>
    </Window.Resources>

        <DockPanel>

        <!-- MENU -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="Plik">
                <MenuItem Header="Nowy Plik" Click="NewFile_Click"/>
                <MenuItem Header="Zapisz" Click="Save_Click"/>
                <MenuItem Header="Zapisz jako">
                    <MenuItem Header="PNG" Click="SaveAsPng_Click"/>
                    <MenuItem Header="JPG" Click="SaveAsJpg_Click"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Otwórz" Click="Open_Click"/>
                <MenuItem Header="Zamknij" Click="Close_Click"/>
            </MenuItem>
            <MenuItem Header="Zaznaczenie">
                <MenuItem Header="Usuń zaznaczenie" Click="remove_Select"/>
                <MenuItem Header="Odwróć zaznaczenie" Click="invert_Select"/>
            </MenuItem>
        </Menu>

        <!-- GŁÓWNY UKŁAD -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>

            <!-- PANEL BOCZNY -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="10">
                <StackPanel>
                    <Button Content="Dodaj Warstwę" Click="AddLayer_Click" Margin="0,5"/>
                    <Button Content="W górę" Click="MoveLayerUp_Click" Margin="0,5"/>
                    <Button Content="W dół" Click="MoveLayerDown_Click" Margin="0,5"/>
                    <ListBox x:Name="LayerList" Background="LightGray"
                             SelectionChanged="LayerList_SelectionChanged"
                             MouseRightButtonUp="LayerList_MouseRightButtonUp"
                             DisplayMemberPath="Name"
                             Height="300" Margin="0,10"/>
                    <Button Content="Pióro" Click="SetToolToPen" Margin="0,5"/>
                    <Button Content="Gumka" Click="SetToolToEraser" Margin="0,5"/>
                    <Label Content="Brush Size:"/>
                    <Slider x:Name="BrushSize" Minimum="1" Maximum="50" Value="1" 
                            ValueChanged="BrushSizeSlider_ValueChanged"
                            Width="150" Margin="0,5"/>
                    <Button Content="Linia" Click="Tool_Line_Click"/>
                    <Button Content="Prostokąt" Click="Tool_Rectangle_Click"/>
                    <Button Content="Koło" Click="Tool_Ellipse_Click"/>
                    <Button Content="Zaznacz prostokąt" Click="Tool_SelectRect_Click"/>
                    <Button Content="Zaznacz dowolny" Click="Tool_SelectFree_Click"/>
                </StackPanel>
            </ScrollViewer>

            <!-- OBSZAR RYSOWANIA Z ZOOMEM -->
            <ScrollViewer Grid.Column="1" Background="LightGray"
                          HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Auto">
                <Canvas x:Name="DrawingCanvas"
                        Width="800" Height="600"
                        Background="White"
                        MouseDown="Canvas_MouseDown"
                        MouseMove="Canvas_MouseMove"
                        MouseUp="Canvas_MouseUp"
                        MouseWheel="DrawingCanvas_MouseWheel"
                        RenderTransformOrigin="0,0">
                    <Canvas.RenderTransform>
                        <ScaleTransform x:Name="CanvasScale" ScaleX="1" ScaleY="1"/>
                    </Canvas.RenderTransform>
                </Canvas>
            </ScrollViewer>
            
            <ScrollViewer Grid.Column="2" Margin="10">
                <StackPanel>
                <mah:ColorCanvas 
                    SelectedColorChanged="ColorPicker_SelectedColorChanged"
                    SelectedColor="Black"/>
                    <Label Name="OpacityLabel" Content="Opacity:"/>
                    <Slider x:Name="OpacitySlider" Minimum="0" Maximum="1" Value="1" 
                        ValueChanged="OpacitySlider_ValueChanged"
                        Width="150" Margin="0,5"/>
                </StackPanel>
                
            </ScrollViewer>
           

        </Grid>
    </DockPanel>
</Window>
